#!/usr/bin/sh
#
# Extract the dependencies for the given target.
#
# Author:   Alastair Hughes
# Contact:  < hobbitalastair at yandex dot com >

source "$(dirname "$0")/../../libmain.sh"
source "$(dirname "$0")/../../libtarget.sh"

# We depend on the source tarball and the srcinfo.
printf "srctar/${target}\n"
printf "srcinfo/${target}\n"

# We also depend on some other packages.
# TODO: Figure out how to extract the dependency information from the
#       .SRCINFO - including host/target dependencies, local vs native system
#       packages, and other such things.
#       Note that this may be problematic - does the build system recheck
#       dependencies, or at least handle them changing as dependencies are
#       rebuilt?
path="${configdir}/src/${target}/PKGBUILD"
exists "${path}" || exit "$?"
sed -n -e 's:  *: :g' -e '/# Depends:/p' < "${path}" | \
    sed -e 's:# Depends\:::' | \
    tr ' ' '\n' | \
    randomise
